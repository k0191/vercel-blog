<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>Navidrome 搭建个人音乐服务器</title>
    <url>/posts/20230706/122130.html</url>
    <content><![CDATA[<div class="note blue no-icon flat"><p>本站展示的 <a href="http://ikuna.cool/music">音乐模块</a> 中介绍的音乐站点均是使用 <a href="https://www.navidrome.org/">Navidrome</a> 的开源音乐服务器方案建立的。我将其部署在了阿里云上，以便多端进行访问，从而尽情享受 <span class='nota' data-nota='简洁的音乐播放器 + 免费的音乐资源'>听歌自由</span>。</p>
<ul>
<li>Navidrome 官方教程文档 <a href="https://www.navidrome.org/docs/">https://www.navidrome.org/docs/</a></li>
<li>Github 开源地址地址 <a href="https://github.com/navidrome/navidrome/">https://github.com/navidrome/navidrome/</a></li>
</ul>
</div>
<h1 id="1-Navidrome-介绍"><a href="#1-Navidrome-介绍" class="headerlink" title="1. Navidrome 介绍"></a>1. Navidrome 介绍</h1><h2 id="1-1-音乐站点效果展示"><a href="#1-1-音乐站点效果展示" class="headerlink" title="1.1. 音乐站点效果展示"></a>1.1. 音乐站点效果展示</h2><div class="tabs" id="xiaoguo"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#xiaoguo-1">桌面Web</button></li><li class="tab"><button type="button" data-href="#xiaoguo-2">手机Web</button></li><li class="tab"><button type="button" data-href="#xiaoguo-3">手机客户端(substreamer)</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="xiaoguo-1"><div class="gallery">
    <div class="fj-gallery  data" data-rowHeight="220" data-limit="10">
    <span class="gallery-data">[{"url":"https://source.k0191.cyou/img/webp/zhuomianweb.webp","alt":""}]</span>
    </div>
    <button class="gallery-load-more"><span>加载更多</span><i class="fa-solid fa-arrow-down"></i></button>
    </div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="xiaoguo-2"><div class="gallery">
    <div class="fj-gallery  data" data-rowHeight="220" data-limit="10">
    <span class="gallery-data">[{"url":"https://source.k0191.cyou/img/webp/shoujiweb.webp","alt":""}]</span>
    </div>
    <button class="gallery-load-more"><span>加载更多</span><i class="fa-solid fa-arrow-down"></i></button>
    </div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="xiaoguo-3"><div class="gallery">
    <div class="fj-gallery  data" data-rowHeight="220" data-limit="10">
    <span class="gallery-data">[{"url":"https://source.k0191.cyou/img/webp/substreamer.webp","alt":""}]</span>
    </div>
    <button class="gallery-load-more"><span>加载更多</span><i class="fa-solid fa-arrow-down"></i></button>
    </div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div>
<h2 id="1-2-介绍"><a href="#1-2-介绍" class="headerlink" title="1.2. 介绍"></a>1.2. 介绍</h2><p>官网简介: Navidrome 是一个自托管的开源音乐服务器和流媒体。它让您可以自由地从任何浏览器或移动设备收听您的音乐收藏。它还可以用作轻量级的 Subsonic-API 兼容服务器，可以与任何 兼容 Subsonic 的客户端一起使用。</p>
<ul>
<li><p><strong>什么是流媒体？</strong><br>流媒体指的是通过 <code>网络</code> 传输的 <span class='nota' data-nota='信息的载体'>媒体</span>，是在网络中 <code>流动</code> 的媒体，比如视频流、音频流、文字流等。</p>
</li>
<li><p><strong>什么是视频流、音乐流？</strong><br>在网络中传输的数据都是以二进制的数据传输的，而我们认知的媒体都是连续的，于是就需要对媒体进行处理，得到可以在网络中进行传输的数据流。而对应的处理技术就称为 <strong><code>流媒体技术</code></strong></p>
</li>
</ul>
<h2 id="1-3-特点"><a href="#1-3-特点" class="headerlink" title="1.3. 特点"></a>1.3. 特点</h2><ul>
<li>处理非常大的音乐收藏</li>
<li>流式传输几乎任何可用的音频格式</li>
<li>读取并使用您精心策划的所有ID3标签中的元数据</li>
<li>多用户，每个用户都有自己的播放次数、播放列表、收藏夹等</li>
<li>非常低的资源使用率：例如：具有 300GB（~29000 首歌曲）的库, 它使用不到 50MB 的 RAM</li>
<li>多平台，可在 macOS、Linux 和 Windows 上运行, 还提供了 Docker 镜像</li>
<li>自动监视您的库的更改、导入新文件和重新加载新元数据</li>
<li>基于 Material UI 的主题化、现代和响应式 Web 界面, 用于管理用户和浏览您的图书馆</li>
<li>与所有 Subsonic/Madsonic/Airsonic 客户端兼容, 查看经过测试的客户列表</li>
<li>即时转码/下采样, 可以为每个用户/玩家设置, 支持 Opus 编码</li>
</ul>
<h2 id="1-4-支持的平台"><a href="#1-4-支持的平台" class="headerlink" title="1.4. 支持的平台"></a>1.4. 支持的平台</h2><p>除了可以使用搭建的网页端 Web UI，Navidrome 还可以与以下所有 Subsonic 客户端兼容。以下客户端经过测试并确认可以正常工作：</p>
<ul>
<li>iOS：substreamer、Amperfy、iSub</li>
<li>安卓：DSub、Subtracks、substreamer、Ultrasonic、Audinaut</li>
<li>网络：Subplayer、Airsonic、Refix、Aurial、Jamstash、Subfire</li>
<li>桌面：Sublime Music(Linux)、Sonixd(Windows/Linux/macOS)</li>
<li>CLI：Jellycli(Windows/Linux)、STMP(Linux/macOS)</li>
</ul>
<span class='p h4 green logo'>以上应用均可在相应的软件商店找到</span>
<h1 id="2-docker-和-docker-compose-安装"><a href="#2-docker-和-docker-compose-安装" class="headerlink" title="2. docker 和 docker-compose 安装"></a>2. docker 和 docker-compose 安装</h1><p>由于 Navidrome 提供了 <strong><code>Docker</code></strong> 镜像，使用 docker 进行安装部署是非常方便的，也不用担心环境问题。</p>
<p>我是使用 <strong><code>docker-compose</code></strong> 对 docker 的镜像包进行安装和部署。<br>关于这二者的介绍可参考<a href="https://blog.csdn.net/IT_rookie_newbie/article/details/119957051?ops_request_misc=&amp;request_id=f0bdd420419f4a709671129ab653f7c2&amp;biz_id=&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~blog~koosearch~default-1-119957051-null-null.268^v1^control&amp;utm_term=docker&amp;spm=1018.2226.3001.4450">这篇文章</a>。<br>下面是安装步骤。</p>
<div class="tabs" id="anzhuang"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#anzhuang-1">Windows</button></li><li class="tab"><button type="button" data-href="#anzhuang-2">Linux-Ubuntu</button></li><li class="tab"><button type="button" data-href="#anzhuang-3">Linux-CentOS</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="anzhuang-1"><p><strong>安装 docker</strong><br>在 Windows 上直接到官网下载安装就行</p>
<p> <a href="https://www.docker.com/get-started/">下载地址</a></p>
<p><strong>安装 docker-compose</strong></p>
<p> <a href="https://gitcode.net/mirrors/docker/compose/-/releases#v2.19.1">下载地址</a><br> 这是对应2.19.1的版本，找到你的windows对应架构的 <strong>exe</strong> 文件下载就ok了。</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="anzhuang-2"><p>可能你的 Ubuntu 上有旧版本的 docker，这里可以先卸载一下<br><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo apt-get remove docker docker-engine docker.io containerd runc</span><br></pre></td></tr></table></figure></p>
<p><strong>安装几个会用到的工具</strong><br><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo apt-get update</span><br><span class="line">sudo apt-get install \</span><br><span class="line">    apt-transport-https \</span><br><span class="line">    ca-certificates \</span><br><span class="line">    curl \</span><br><span class="line">    gnupg \</span><br><span class="line">    lsb-release</span><br></pre></td></tr></table></figure><br><strong>防伪</strong><br><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo gpg --dearmor -o /usr/share/keyrings/docker-archive-keyring.gpg</span><br></pre></td></tr></table></figure></p>
<p><strong>下载仓库文件</strong><br><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">echo \</span><br><span class="line">  &quot;deb [arch=amd64 signed-by=/usr/share/keyrings/docker-archive-keyring.gpg] https://download.docker.com/linux/ubuntu \</span><br><span class="line"><span class="meta prompt_">  $</span><span class="language-bash">(lsb_release -cs) stable<span class="string">&quot; | sudo tee /etc/apt/sources.list.d/docker.list &gt; /dev/null</span></span></span><br></pre></td></tr></table></figure></p>
<p><strong>安装 docker 引擎</strong><br><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo apt-get update</span><br><span class="line">sudo apt-get install docker-ce docker-ce-cli containerd.io -y</span><br></pre></td></tr></table></figure></p>
<p><strong>安装 docker-compose</strong><br><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo curl -L https://get.daocloud.io/docker/compose/releases/download/v2.19.1/docker-compose-`uname -s`-`uname -m` -o /usr/local/bin/docker-compose</span><br><span class="line">sudo chmod +x /usr/local/bin/docker-compose</span><br></pre></td></tr></table></figure></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="anzhuang-3"><p>大多数云服务器是使用的 CentOS 的系统，如果你需要将 Navidrome 部署到云服务器上，就按照以下指令进行安装。</p>
<p><strong>旧版本卸载</strong><br><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo yum remove docker \</span><br><span class="line">                  docker-client \</span><br><span class="line">                  docker-client-latest \</span><br><span class="line">                  docker-common \</span><br><span class="line">                  docker-latest \</span><br><span class="line">                  docker-latest-logrotate \</span><br><span class="line">                  docker-logrotate \</span><br><span class="line">                  docker-engine</span><br></pre></td></tr></table></figure></p>
<p><strong>安装yum-utils软件包</strong><br><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo yum install -y yum-utils</span><br><span class="line">sudo yum-config-manager \</span><br><span class="line">    --add-repo \</span><br><span class="line">    https://download.docker.com/linux/centos/docker-ce.repo</span><br></pre></td></tr></table></figure></p>
<p><strong>安装docker引擎</strong><br><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo yum install docker-ce docker-ce-cli containerd.io</span><br></pre></td></tr></table></figure><br>若报 <code>containerd.io</code> 的版本错误，则重新下载最新的 <code>containerd.io</code><br><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo dnf install https://download.docker.com/linux/centos/7/x86_64/stable/Packages/containerd.io-1.2.6-3.3.el7.x86_64.rpm</span><br></pre></td></tr></table></figure></p>
<p><strong>安装docker-compose</strong><br><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo curl -L &quot;https://github.com/docker/compose/releases/download/1.26.0/docker-compose-$(uname -s)-$(uname -m)&quot; -o /usr/local/bin/docker-compose</span><br><span class="line">sudo chmod +x /usr/local/bin/docker-compose</span><br></pre></td></tr></table></figure></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div>
<h1 id="3-使用-docker-compose-部署-Navidrome"><a href="#3-使用-docker-compose-部署-Navidrome" class="headerlink" title="3. 使用 docker-compose 部署 Navidrome"></a>3. 使用 docker-compose 部署 Navidrome</h1><div class="tabs" id="bushu"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#bushu-1">Windows</button></li><li class="tab"><button type="button" data-href="#bushu-2">Linux</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="bushu-1"><p>在你电脑磁盘空间充足的下创建一个项目文件夹，如 <code>D://music-server</code><br>在该文件夹下新建以下三个子文件夹<br><figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="string">music-server</span></span><br><span class="line">   <span class="string">conf</span>  <span class="comment"># 存放 docker-compose 的配置文件</span></span><br><span class="line">   <span class="string">music</span> <span class="comment"># 存放你的音乐文件</span></span><br><span class="line">   <span class="string">db</span>    <span class="comment"># 存放 Navidrome 运行时的一些数据文件</span></span><br></pre></td></tr></table></figure></p>
<p>在 <code>conf</code> 路径下创建一个 <code>docker-compose.yml</code> 文件，贴入以下代码<br><figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">version:</span> <span class="string">&quot;3&quot;</span></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line">  <span class="attr">navidrome1:</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">navidrome</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">deluan/navidrome:latest</span></span><br><span class="line"></span><br><span class="line">    <span class="attr">user:</span> <span class="number">1000</span><span class="string">:1000</span></span><br><span class="line"></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;4533:4533&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="attr">restart:</span> <span class="string">unless-stopped</span></span><br><span class="line"></span><br><span class="line">    <span class="attr">environment:</span></span><br><span class="line">      <span class="attr">ND_PORT:</span> <span class="number">4533</span></span><br><span class="line">      <span class="attr">ND_DEFAULTLANGUAGE:</span> <span class="string">zh-Hans</span></span><br><span class="line">      <span class="attr">ND_SCANSCHEDULE:</span> <span class="string">1m</span></span><br><span class="line">      <span class="attr">ND_ENABLETRANSCODINGCONFIG:</span> <span class="number">1</span></span><br><span class="line">      <span class="attr">ND_ENABLEDOWNLOADS:</span> <span class="number">1</span></span><br><span class="line">      <span class="attr">ND_LOGLEVEL:</span> <span class="string">info</span></span><br><span class="line">      <span class="attr">ND_SESSIONTIMEOUT:</span> <span class="string">24h</span></span><br><span class="line">      <span class="attr">ND_BASEURL:</span> <span class="string">&quot;&quot;</span></span><br><span class="line">      <span class="attr">ND_UIWELCOMEMESSAGE:</span> <span class="string">&quot;welcome to k0191&#x27;s music server&quot;</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;D://music-server/db:/data&quot;</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;D://music-server/music:/music:ro&quot;</span></span><br></pre></td></tr></table></figure></p>
<p>打开 <span class='nota' data-nota='按 Win + R 键，输入 cmd'>Windows命令台</span>, 在其中输入<br><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">docker-compose -f d://music-server/conf/docker-compose.yml up -d</span><br></pre></td></tr></table></figure></p>
<p>查看是否运行成功，可以在命令台输入:<br><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">docker ps</span><br></pre></td></tr></table></figure></p>
<p>打开浏览器，输入<code>http://localhost:4533/</code> 就可以看到一个登录界面，第一次登陆创建的用户为 <code>admin</code> 用户，可以创建和管理其他用户。</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="bushu-2"><p>Linux上的配置文件和Windos一样，只用更改相应的路径即可。<br>如:在将<code>/home/k019/project/music-server</code>作为我的项目根目录。<br><figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">version:</span> <span class="string">&quot;3&quot;</span></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line">  <span class="attr">my-navidrome:</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">navidrome</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">deluan/navidrome:latest</span></span><br><span class="line"></span><br><span class="line">    <span class="attr">user:</span> <span class="number">1000</span><span class="string">:1000</span></span><br><span class="line"></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;4533:4533&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="attr">restart:</span> <span class="string">unless-stopped</span></span><br><span class="line"></span><br><span class="line">    <span class="attr">environment:</span></span><br><span class="line">      <span class="attr">ND_PORT:</span> <span class="number">4533</span></span><br><span class="line">      <span class="attr">ND_DEFAULTLANGUAGE:</span> <span class="string">zh-Hans</span></span><br><span class="line">      <span class="attr">ND_SCANSCHEDULE:</span> <span class="string">1m</span></span><br><span class="line">      <span class="attr">ND_ENABLETRANSCODINGCONFIG:</span> <span class="number">1</span></span><br><span class="line">      <span class="attr">ND_ENABLEDOWNLOADS:</span> <span class="number">1</span></span><br><span class="line">      <span class="attr">ND_LOGLEVEL:</span> <span class="string">info</span></span><br><span class="line">      <span class="attr">ND_SESSIONTIMEOUT:</span> <span class="string">24h</span></span><br><span class="line">      <span class="attr">ND_BASEURL:</span> <span class="string">&quot;&quot;</span></span><br><span class="line">      <span class="attr">ND_UIWELCOMEMESSAGE:</span> <span class="string">&quot;welcome to k0191&#x27;s music server&quot;</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;/home/k0191/project/music-server/db:/data&quot;</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;/home/k0191/project/music-server/music:/music:ro&quot;</span></span><br></pre></td></tr></table></figure></p>
<p>启动指令<br><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">docker-compose -f /home/k0191/project/music-server/conf/docker-compose.yml up -d</span><br></pre></td></tr></table></figure></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div>
<h2 id="3-1-参数说明"><a href="#3-1-参数说明" class="headerlink" title="3.1. 参数说明"></a>3.1. 参数说明</h2><div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:center">参数</th>
<th style="text-align:left">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">version 3</td>
<td style="text-align:left">表示compose对docker版本的支持，这里是compose的版本，并非是docker的版本</td>
</tr>
<tr>
<td style="text-align:center">services</td>
<td style="text-align:left">表示一个该配置文件的所有容器实例，支持配置多个容器实例</td>
</tr>
<tr>
<td style="text-align:center">my-navidrome</td>
<td style="text-align:left">服务名称，同一网络上的其他容器可以使用服务名称或别名来连接到其他服务的容器</td>
</tr>
<tr>
<td style="text-align:center">container_name</td>
<td style="text-align:left">容器实例的名称</td>
</tr>
<tr>
<td style="text-align:center">image</td>
<td style="text-align:left">发布的实例镜像的名称，以及版本，latest:表示最新的</td>
</tr>
<tr>
<td style="text-align:center">ports</td>
<td style="text-align:left">暴露的端口, 指定两个端口(HOST:CONTAINER),可设定多组</td>
</tr>
<tr>
<td style="text-align:center">restart</td>
<td style="text-align:left">重启策略 <br> “no”: 默认，在任何时候都不会重启容器 <br> always: 容器总是重新启动 <br> on-failure: 退出代码出错时重启 <br> unless-stopped: 总是重新启动容器，除非容器停止</td>
</tr>
<tr>
<td style="text-align:center">environment</td>
<td style="text-align:left">设置运行的环境变量</td>
</tr>
<tr>
<td style="text-align:center">volumes</td>
<td style="text-align:left">挂载，即将本地路径与容器内的路径进行映射</td>
</tr>
</tbody>
</table>
</div>
<h2 id="3-2-Navidrome-环境变量说明"><a href="#3-2-Navidrome-环境变量说明" class="headerlink" title="3.2. Navidrome 环境变量说明"></a>3.2. Navidrome 环境变量说明</h2><p>官网的说明: <a href="https://www.navidrome.org/docs/usage/configuration-options/#configuration-file">点击前往</a></p>
<p>常用参数说明</p>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:center">参数</th>
<th style="text-align:left"><center>说明</center></th>
<th style="text-align:left"><center>默认值</center></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">ND_PORT</td>
<td style="text-align:left">服务器侦听的端口</td>
<td style="text-align:left"><code>4533</code></td>
</tr>
<tr>
<td style="text-align:center">ND_ADDRESS</td>
<td style="text-align:left">服务器绑定的IP地址</td>
<td style="text-align:left"><code>0.0.0.0</code> and :: (all IPs)</td>
</tr>
<tr>
<td style="text-align:center">ND_BASEURL</td>
<td style="text-align:left">服务器的根目录</td>
<td style="text-align:left"><code>/</code></td>
</tr>
<tr>
<td style="text-align:center">ND_DATAFOLDER</td>
<td style="text-align:left">数据文件存放目录,指定后，需修改上述配置文件中的挂载目录</td>
<td style="text-align:left"><code>&quot;./data&quot;</code></td>
</tr>
<tr>
<td style="text-align:center">ND_MUSICFOLDER</td>
<td style="text-align:left">音乐文件存放目录,指定后，需修改上述配置文件中的挂载目录</td>
<td style="text-align:left"><code>&quot;./music&quot;</code></td>
</tr>
<tr>
<td style="text-align:center">ND_DEFAULTLANGUAGE</td>
<td style="text-align:left">默认的语言, 支持简体中文, <code>zh-Hans</code></td>
<td style="text-align:left"><code>en</code></td>
</tr>
<tr>
<td style="text-align:center">ND_ENABLEDOWNLOADS</td>
<td style="text-align:left">是否可以下载</td>
<td style="text-align:left"><code>true</code></td>
</tr>
<tr>
<td style="text-align:center">ND_SESSIONTIMEOUT</td>
<td style="text-align:left">空闲会话超时</td>
<td style="text-align:left"><code>&quot;24h&quot;</code></td>
</tr>
<tr>
<td style="text-align:center">ND_LASTFM_APIKEY</td>
<td style="text-align:left">配置last.fm 所需要的 key,支持通过last.fm的API获取歌手专辑等信息</td>
<td style="text-align:left">留空</td>
</tr>
<tr>
<td style="text-align:center">ND_MAXSIDEBARPLAYLISTS</td>
<td style="text-align:left">设置UI侧栏中显示的最大播放列表数。请注意，数量过大可能会导致UI性能问题</td>
<td style="text-align:left">100</td>
</tr>
<tr>
<td style="text-align:center">ND_SCANSCHEDULE</td>
<td style="text-align:left">扫描周期，多久扫描一次音乐库</td>
<td style="text-align:left"><code>1m</code></td>
</tr>
<tr>
<td style="text-align:center">ND_TRANSCODINGCACHESIZE</td>
<td style="text-align:left">转码缓存</td>
<td style="text-align:left"><code>100MB</code></td>
</tr>
<tr>
<td style="text-align:center">ND_UIWELCOMEMESSAGE</td>
<td style="text-align:left">登录界面的欢迎信息</td>
<td style="text-align:left">空</td>
</tr>
<tr>
<td style="text-align:center">ND_SPOTIFY_ID <br> ND_SPOTIFY_SECRET</td>
<td style="text-align:left">通过spotify获取歌曲封面信息</td>
<td style="text-align:left">留空</td>
</tr>
</tbody>
</table>
</div>
<h1 id="4-导入歌曲说明"><a href="#4-导入歌曲说明" class="headerlink" title="4. 导入歌曲说明"></a>4. 导入歌曲说明</h1><p>国内使用last.fm和spotify的API服务可能会很慢，故在配置文件中没有加入这两点。一般歌曲的封面和专辑信息都包含在了歌曲的文件中，不需要额外去获取，但歌词信息不同。</p>
<p>Navidrome 是支持歌词显示的，需要确保你下载的歌曲中有歌词的ID3标签，但一般为了歌曲体积，网上多数是将<span class='nota' data-nota='一般格式为LRC，其后缀为.lrc'>歌词文件</span> 与音乐文件分开管理的，所以下载歌曲时需要将歌词文件一同下载下来。然后再用 music-tag等工具将歌词导入到原歌曲文件中，这样使用 Navidrome 播放的音乐就可以看到歌词了。</p>
<p>这里我推荐一款修改音乐标签的工具:<br><a href="https://www.cnblogs.com/vinlxc/p/11347744.html">MusicTag</a></p>
]]></content>
      <categories>
        <category>教程</category>
      </categories>
      <tags>
        <tag>网站</tag>
        <tag>docker</tag>
      </tags>
  </entry>
  <entry>
    <title>Hexo + Butterfly 搭建个人博客</title>
    <url>/posts/20230626/170147.html</url>
    <content><![CDATA[<div class="note blue no-icon flat"><p>本网站基于 <strong><code>hexo</code></strong> 框架和 <strong><code>butterfly</code></strong> 主题进行搭建，由 <strong><code>Gitee Pages</code></strong> 提供部署服务，以下是参考链接</p>
<ul>
<li>Hexo: <a href="https://hexo.io/zh-cn/docs/">https://hexo.io/zh-cn/docs/</a></li>
<li>Butterfly: <a href="https://butterfly.js.org/">https://butterfly.js.org/</a></li>
<li>Fomalhaut: <a href="https://www.fomal.cn/">https://www.fomal.cn/</a></li>
</ul>
<p>本站使用的hexo版本为 <a href="https://github.com/hexojs/hexo/releases/tag/6.3.0">6.3.0</a>, butterfly版本为 <a href="https://github.com/jerryc127/hexo-theme-butterfly/releases/tag/4.9.0">4.9.0</a></p>
<p><span class='p h4 green logo'>本文章是对自己建站过程的记录，大部分内容来源于上述链接，对操作步骤进行了适应性调整，方便您更快速的掌握建站的过程</span></p>
</div>
<h1 id="1-环境准备"><a href="#1-环境准备" class="headerlink" title="1. 环境准备"></a>1. 环境准备</h1><p>在正式建站之前，你需要准备以下工具或账号，具体的安装步骤网上有很多，这里不再赘述，你可以参考这篇文章<a href="https://www.fomal.cc/posts/e593433d.html">Hexo博客搭建基础教程(一)</a>。</p>
<ul>
<li><strong><code>Git</code></strong></li>
<li><strong><code>Node</code></strong></li>
<li><strong><code>Github账号</code></strong></li>
<li><strong><code>Hexo</code></strong></li>
<li><strong><code>VS Code</code></strong></li>
<li><strong><code>个人域名</code></strong></li>
</ul>
<p><strong><code>VS Code</code></strong> 工具是非必须的，但它能更好的帮助你进行项目管理，它可以很方便的书写 <strong><code>MARKDOWN</code></strong> 文档，提供Git的可视化工具，你也可以使用 <a href="https://typoraio.cn/">Typroa</a> 工具来编辑 <strong><code>MARKDOWN</code></strong> 文档，但此工具目前是收费的，对白嫖玩家来说就又增加了项找破解版的步骤，故不太推荐。 关于 <strong><code>VS Code</code></strong> 和 <strong><code>Git</code></strong> 工具的使用可参考这篇文章<a href="https://blog.csdn.net/weixin_43314519/article/details/107572206">VScode 结合git的全面使用流程</a></p>
<h1 id="2-Hexo初始化"><a href="#2-Hexo初始化" class="headerlink" title="2. Hexo初始化"></a>2. Hexo初始化</h1><p>在电脑任意路径下新建一个空的文件夹，建议以项目名命名，使用 <strong><code>VS Code</code></strong> 打开该文件夹，在 <strong><code>VS Code</code></strong> 中打开 <strong><code>Git Bash</code></strong> 终端，输入以下命令:<br><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">hexo init</span><br><span class="line">npm install</span><br></pre></td></tr></table></figure></p>
<h1 id="3-Butterfly主题安装"><a href="#3-Butterfly主题安装" class="headerlink" title="3. Butterfly主题安装"></a>3. Butterfly主题安装</h1><p>在该项目文件夹下，打开 <strong><code>Git Bash</code></strong> 终端，输入:<br><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">npm i hexo-theme-butterfly</span><br></pre></td></tr></table></figure><br>更新:<br><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">npm update hexo-theme-butterfly</span><br></pre></td></tr></table></figure></p>
<h2 id="3-1-应用主题"><a href="#3-1-应用主题" class="headerlink" title="3.1. 应用主题"></a>3.1. 应用主题</h2><p>为防止后续更新主题，导致自定义配置失效，将主题文件夹<code>themes/</code>下的<code>_config.yml</code>复制到项目文件夹目录下，并重命名为<code>_config.butterfly.yml</code>，后续主题配置的修改将在该文件上进行，主题文件夹下的<code>_config.yml</code>应保留，后续改动出错后，可参照进行回滚。</p>
<p>修改项目文件夹下的<code>_config.yml</code>站点配置文件，进行如下修改:<br><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">theme: butterfly</span><br></pre></td></tr></table></figure></p>
<h2 id="3-2-安装主题渲染器"><a href="#3-2-安装主题渲染器" class="headerlink" title="3.2. 安装主题渲染器"></a>3.2. 安装主题渲染器</h2><p>如果没有pug以及stylus的渲染器，请下载安装，这两个渲染器是Butterfly生成基础页面所需的依赖包:<br><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">npm install hexo-renderer-pug hexo-renderer-stylus --save</span><br></pre></td></tr></table></figure></p>
<h2 id="3-3-修改主题CDN"><a href="#3-3-修改主题CDN" class="headerlink" title="3.3 修改主题CDN"></a>3.3 修改主题CDN</h2><p>主题所使用的一些js脚本的资源站，可能国内访问较慢，导致网站渲染的结果与实际不符，遇到渲染与教程中不同时，需要查看网页源码，看是不是渲染的脚本请求超时导致的，以下为从<a href="https://www.fomal.cn/">Fomalhaut</a>的开源项目中拷贝来的配置，请务必修改修改 <strong><code>_config.butterfly.yml</code></strong> 中的参数如下:</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># CDN</span></span><br><span class="line"><span class="comment"># Don&#x27;t modify the following settings unless you know how they work</span></span><br><span class="line"><span class="comment"># 非必要請不要修改</span></span><br><span class="line"><span class="attr">CDN:</span></span><br><span class="line">  <span class="comment"># The CDN provider of internal scripts (主題內部 js 的 cdn 配置)</span></span><br><span class="line">  <span class="comment"># option: local/jsdelivr/unpkg/cdnjs/custom</span></span><br><span class="line">  <span class="comment"># Dev version can only choose. ( dev版的主題只能設置為 local )</span></span><br><span class="line">  <span class="attr">internal_provider:</span> <span class="string">local</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># The CDN provider of third party scripts (第三方 js 的 cdn 配置)</span></span><br><span class="line">  <span class="comment"># option: local/jsdelivr/unpkg/cdnjs/custom</span></span><br><span class="line">  <span class="comment"># when set it to local, you need to install hexo-butterfly-extjs</span></span><br><span class="line">  <span class="attr">third_party_provider:</span> <span class="string">cdnjs</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># Add version number to CDN, true or false</span></span><br><span class="line">  <span class="attr">version:</span> <span class="literal">false</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># Custom format</span></span><br><span class="line">  <span class="comment"># For example: https://cdn.staticfile.org/$&#123;cdnjs_name&#125;/$&#123;version&#125;/$&#123;min_cdnjs_file&#125;</span></span><br><span class="line">  <span class="attr">custom_format:</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">option:</span></span><br><span class="line">    <span class="comment"># main_css:</span></span><br><span class="line">    <span class="comment"># main:</span></span><br><span class="line">    <span class="comment"># utils:</span></span><br><span class="line">    <span class="comment"># translate: https://cdn1.tianli0.top/npm/js-heo@1.0.6/translate/tw_cn.js</span></span><br><span class="line">    <span class="comment"># local_search:</span></span><br><span class="line">    <span class="comment"># algolia_js: </span></span><br><span class="line">    <span class="attr">busuanzi:</span> <span class="string">https://cdn.bootcdn.net/ajax/libs/busuanzi/2.3.0/bsz.pure.mini.min.js</span></span><br><span class="line">    <span class="attr">algolia_search_v4:</span> <span class="string">https://cdn.staticfile.org/algoliasearch/4.14.3/algoliasearch-lite.umd.min.js</span></span><br><span class="line">    <span class="attr">instantsearch_v4:</span> <span class="string">https://cdn.staticfile.org/instantsearch.js/4.49.2/instantsearch.production.min.js</span></span><br><span class="line">    <span class="attr">pjax:</span> <span class="string">https://lib.baomitu.com/pjax/0.2.8/pjax.min.js</span></span><br><span class="line">    <span class="comment"># gitalk: https://lf6-cdn-tos.bytecdntp.com/cdn/expire-1-M/gitalk/1.7.2/gitalk.min.js</span></span><br><span class="line">    <span class="comment"># gitalk_css: https://lf6-cdn-tos.bytecdntp.com/cdn/expire-1-M/gitalk/1.7.2/gitalk.min.css</span></span><br><span class="line">    <span class="comment"># blueimp_md5:</span></span><br><span class="line">    <span class="comment"># valine: https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/valine/1.4.16/Valine.min.js</span></span><br><span class="line">    <span class="comment"># disqusjs: https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/disqusjs/1.3.0/disqus.js</span></span><br><span class="line">    <span class="comment"># disqusjs_css: https://lf6-cdn-tos.bytecdntp.com/cdn/expire-1-M/disqusjs/1.3.0/disqusjs.css</span></span><br><span class="line">    <span class="attr">twikoo:</span> <span class="string">https://cdn.staticfile.org/twikoo/1.6.8/twikoo.all.min.js</span></span><br><span class="line">    <span class="comment"># waline_js: https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/waline/1.5.4/Waline.min.js</span></span><br><span class="line">    <span class="comment"># waline_css:</span></span><br><span class="line">    <span class="attr">sharejs:</span> <span class="string">https://lib.baomitu.com/social-share.js/1.0.16/js/social-share.min.js</span></span><br><span class="line">    <span class="attr">sharejs_css:</span> <span class="string">https://lib.baomitu.com/social-share.js/1.0.16/css/share.min.css</span></span><br><span class="line">    <span class="comment"># mathjax: https://cdn.staticfile.org/mathjax/3.2.2/es5/mml-chtml.min.js</span></span><br><span class="line">    <span class="comment"># katex: https://lib.baomitu.com/KaTeX/latest/katex.min.css</span></span><br><span class="line">    <span class="comment"># katex_copytex:</span></span><br><span class="line">    <span class="comment"># mermaid:</span></span><br><span class="line">    <span class="comment"># canvas_ribbon:</span></span><br><span class="line">    <span class="comment"># canvas_fluttering_ribbon:</span></span><br><span class="line">    <span class="comment"># canvas_nest:</span></span><br><span class="line">    <span class="attr">lazyload:</span> <span class="string">https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/vanilla-lazyload/17.3.1/lazyload.iife.min.js</span></span><br><span class="line">    <span class="attr">instantpage:</span> <span class="string">https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/instant.page/5.1.0/instantpage.min.js</span></span><br><span class="line">    <span class="attr">typed:</span> <span class="string">https://lf9-cdn-tos.bytecdntp.com/cdn/expire-1-M/typed.js/2.0.12/typed.min.js</span></span><br><span class="line">    <span class="comment"># pangu:</span></span><br><span class="line">    <span class="attr">fancybox_css_v4:</span> <span class="string">https://cdn.staticfile.org/fancyapps-ui/4.0.31/fancybox.min.css</span></span><br><span class="line">    <span class="attr">fancybox_v4:</span> <span class="string">https://cdn.staticfile.org/fancyapps-ui/4.0.31/fancybox.umd.min.js</span></span><br><span class="line">    <span class="comment"># medium_zoom: https://lf6-cdn-tos.bytecdntp.com/cdn/expire-1-M/medium-zoom/1.0.6/medium-zoom.min.js</span></span><br><span class="line">    <span class="comment"># snackbar_css: https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/node-snackbar/0.1.16/snackbar.min.css</span></span><br><span class="line">    <span class="comment"># snackbar: https://lf6-cdn-tos.bytecdntp.com/cdn/expire-1-M/node-snackbar/0.1.16/snackbar.min.js</span></span><br><span class="line">    <span class="comment"># activate_power_mode:</span></span><br><span class="line">    <span class="comment"># fireworks:</span></span><br><span class="line">    <span class="comment"># click_heart:</span></span><br><span class="line">    <span class="comment"># ClickShowText:</span></span><br><span class="line">    <span class="attr">fontawesomeV6:</span> <span class="string">https://lf6-cdn-tos.bytecdntp.com/cdn/expire-1-M/font-awesome/6.0.0/css/all.min.css</span></span><br><span class="line">    <span class="comment"># flickr_justified_gallery_js: https://cdn.staticfile.org/flickr-justified-gallery/2.1.2/fjGallery.min.js</span></span><br><span class="line">    <span class="comment"># flickr_justified_gallery_css: https://cdn.staticfile.org/flickr-justified-gallery/2.1.2/fjGallery.min.css</span></span><br><span class="line">    <span class="attr">aplayer_css:</span> <span class="string">https://lf6-cdn-tos.bytecdntp.com/cdn/expire-1-M/aplayer/1.10.1/APlayer.min.css</span></span><br><span class="line">    <span class="attr">aplayer_js:</span> <span class="string">https://lf6-cdn-tos.bytecdntp.com/cdn/expire-1-M/aplayer/1.10.1/APlayer.min.js</span></span><br><span class="line">    <span class="attr">meting_js:</span> <span class="string">https://cdn1.tianli0.top/npm/js-heo@1.0.12/metingjs/Meting.min.js</span></span><br><span class="line">    <span class="comment"># prismjs_js: https://cdn1.tianli0.top/npm/prismjs@1.1.0/prism.js</span></span><br><span class="line">    <span class="comment"># prismjs_lineNumber_js: https://cdn1.tianli0.top/npm/prismjs/plugins/line-numbers/prism-line-numbers.min.js</span></span><br><span class="line">    <span class="comment"># prismjs_autoloader: https://cdn1.tianli0.top/npm/prismjs/plugins/autoloader/prism-autoloader.min.js</span></span><br></pre></td></tr></table></figure>
<h1 id="4-创建文章或页面"><a href="#4-创建文章或页面" class="headerlink" title="4. 创建文章或页面"></a>4. 创建文章或页面</h1><h2 id="4-1-模板"><a href="#4-1-模板" class="headerlink" title="4.1 模板"></a>4.1 模板</h2><p>在项目文件夹下有一个名为 <strong><code>scaffolds</code></strong> 的文件夹，该文件夹用于存放创建新页面或文章的模板 <strong><code>MARKDOWN</code></strong> 文件，在使用 <strong><code>hexo new [page] tags</code></strong> 指令创建新页面或文章时，使其 <strong><code>Front-matter</code></strong> 部分参照模板的样式进行创建。</p>
<details class="folding-tag" blue><summary> e.g. 创建标签页 </summary>
              <div class='content'>
              <p><strong><code>scaffolds/page.md</code></strong> 文件内容如下:<br><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">---</span><br><span class="line">title: &#123;&#123;title&#125;&#125;</span><br><span class="line">date: &#123;&#123;date&#125;&#125;    </span><br><span class="line"><span class="section">type:             </span></span><br><span class="line"><span class="section">---</span></span><br></pre></td></tr></table></figure><br>新建tags页面，输入:<br><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">hexo new page tags</span><br></pre></td></tr></table></figure><br>则会在项目文件夹下的 <strong><code>source/</code></strong> 文件夹下生成一个带有 <strong><code>index.md</code></strong> 文件的 <strong><code>tags/</code></strong> 文件夹<br>其内容为:<br><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">---</span><br><span class="line">title: tags</span><br><span class="line">date: 2023-06-26 20:00:00    </span><br><span class="line"><span class="section">type:             </span></span><br><span class="line"><span class="section">---</span></span><br></pre></td></tr></table></figure></p><ul><li>若要使用该页面作为标签页，则在type 项中填入 “tags”</li><li>若要使用该页面作为分类页，则在type 项中填入 “categories”</li><li>若要使用该页面作为友情链接页，则在type 项中填入 “link”</li><li>其余类型页面可不用填写</li></ul>
              </div>
            </details>
<h2 id="4-2-Front-matter"><a href="#4-2-Front-matter" class="headerlink" title="4.2. Front-matter"></a>4.2. Front-matter</h2><p>Front-matter 是 <strong><code>MARKDOWN</code></strong> 文件最上方以 —- 分隔的区域，用于指定页面或文章的页面配置。</p>
<h3 id="4-2-1-Page-Front-matter"><a href="#4-2-1-Page-Front-matter" class="headerlink" title="4.2.1. Page Front-matter"></a>4.2.1. Page Front-matter</h3><figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">title:</span>            <span class="comment"># 必须 页面标题</span></span><br><span class="line"><span class="attr">date:</span>             <span class="comment"># 必须 页面创建时间</span></span><br><span class="line"><span class="attr">type:</span>             <span class="comment"># 必须 页面类型，标签，分类，友情链接页面必须配置</span></span><br><span class="line"><span class="attr">updated:</span>          <span class="comment"># 可选 页面更新时间</span></span><br><span class="line"><span class="attr">comments:</span>         <span class="comment"># 可选 显示页面评论模块</span></span><br><span class="line"><span class="attr">description:</span>      <span class="comment"># 可选 页面描述</span></span><br><span class="line"><span class="attr">keywords:</span>         <span class="comment"># 可选 页面关键字</span></span><br><span class="line"><span class="attr">top_img:</span>          <span class="comment"># 可选 页面顶部图片</span></span><br><span class="line"><span class="attr">mathjax:</span>          <span class="comment"># 可选 显示mathjax 当设置mathjax的per_page: false时，才需要配置，默认 false</span></span><br><span class="line"><span class="attr">katex:</span>            <span class="comment"># 可选 显示katex 当设置katex的per_page: false时，才需要配置，默认 false</span></span><br><span class="line"><span class="attr">aside:</span>            <span class="comment"># 可选 显示侧边栏</span></span><br><span class="line"><span class="attr">aplayer:</span>          <span class="comment"># 可选 在需要的页面加载aplayer的js和css</span></span><br><span class="line"><span class="attr">highlight_shrink:</span> <span class="comment"># 可选 配置代码框是否展开 默认为设置中highlight_shrink的配置</span></span><br><span class="line"><span class="meta">---</span></span><br></pre></td></tr></table></figure>
<h3 id="4-2-2-Post-Front-matter"><a href="#4-2-2-Post-Front-matter" class="headerlink" title="4.2.2. Post Front-matter"></a>4.2.2. Post Front-matter</h3><figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">title:</span>                    <span class="comment"># 必须 文章标题</span></span><br><span class="line"><span class="attr">date:</span>                     <span class="comment"># 必须 文章创建日期</span></span><br><span class="line"><span class="attr">updated:</span>                  <span class="comment"># 可选 文章更新日期</span></span><br><span class="line"><span class="attr">tags:</span>                     <span class="comment"># 可选 文章标签</span></span><br><span class="line"><span class="attr">categories:</span>               <span class="comment"># 可选 文章分类</span></span><br><span class="line"><span class="attr">keywords:</span>                 <span class="comment"># 可选 文章关键词</span></span><br><span class="line"><span class="attr">description:</span>              <span class="comment"># 可选 文章描述</span></span><br><span class="line"><span class="attr">top_img:</span>                  <span class="comment"># 可选 文章顶部图</span></span><br><span class="line"><span class="attr">comments:</span>                 <span class="comment"># 可选 显示文章评论模块</span></span><br><span class="line"><span class="attr">cover:</span>                    <span class="comment"># 可选 文章缩略图</span></span><br><span class="line"><span class="attr">toc:</span>                      <span class="comment"># 可选 显示文章TOC</span></span><br><span class="line"><span class="attr">toc_number:</span>               <span class="comment"># 可选 显示文章TOC数量</span></span><br><span class="line"><span class="attr">toc_style_simple:</span>         <span class="comment"># 可选 显示TOC简洁模式</span></span><br><span class="line"><span class="attr">copyright:</span>                <span class="comment"># 可选 显示文章版权模块(默认为设置中post_copyright的enable配置)</span></span><br><span class="line"><span class="attr">copyright_author:</span>         <span class="comment"># 可选 文章版权模块的文章作者</span></span><br><span class="line"><span class="attr">copyright_author_href:</span>    <span class="comment"># 可选 文章版权模块的文章作者链接</span></span><br><span class="line"><span class="attr">copyright_url:</span>            <span class="comment"># 可选 文章版权模块的文章链接</span></span><br><span class="line"><span class="attr">copyright_info:</span>           <span class="comment"># 可选 文章版权模块的版权声明文字</span></span><br><span class="line"><span class="attr">mathjax:</span>                  <span class="comment"># 可选 显示mathjax 当设置mathjax的per_page: false时，才需要配置，默认 false</span></span><br><span class="line"><span class="attr">katex:</span>                    <span class="comment"># 可选 显示katex 当设置katex的per_page: false时，才需要配置，默认 false</span></span><br><span class="line"><span class="attr">aside:</span>                    <span class="comment"># 可选 显示侧边栏</span></span><br><span class="line"><span class="attr">aplayer:</span>                  <span class="comment"># 可选 在需要的页面加载aplayer的js和css</span></span><br><span class="line"><span class="attr">highlight_shrink:</span>         <span class="comment"># 可选 配置代码框是否展开 默认为设置中highlight_shrink的配置</span></span><br><span class="line"><span class="meta">---</span></span><br></pre></td></tr></table></figure>
<h1 id="5-主题配置"><a href="#5-主题配置" class="headerlink" title="5. 主题配置"></a>5. 主题配置</h1><h2 id="5-1-网站资料配置"><a href="#5-1-网站资料配置" class="headerlink" title="5.1. 网站资料配置"></a>5.1. 网站资料配置</h2><p>网站资料的配置在项目文件夹下的站点配置文件 <strong><code>_config.yml</code></strong> 中，其主要参数如下:</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">title:</span>              <span class="comment"># 网站标题</span></span><br><span class="line"><span class="attr">subtitle:</span>           <span class="comment"># 网站副标题</span></span><br><span class="line"><span class="attr">description:</span>        <span class="comment"># 网站描述</span></span><br><span class="line"><span class="attr">keywords:</span>           <span class="comment"># 网站的关键词</span></span><br><span class="line"><span class="attr">author:</span>             <span class="comment"># 网站的作者</span></span><br><span class="line"><span class="attr">language:</span>           <span class="comment"># 使用语言</span></span><br><span class="line"><span class="attr">timezone:</span>           <span class="comment"># 使用时区</span></span><br><span class="line"></span><br><span class="line"><span class="attr">url:</span>                <span class="comment"># 网站的url</span></span><br><span class="line"><span class="attr">root:</span>               <span class="comment"># 网站的根目录</span></span><br><span class="line"><span class="attr">permalink:</span>          <span class="comment"># 网站文章页的永久链接</span></span><br><span class="line"><span class="attr">permalink_defaults:</span> <span class="comment"># 文章页永久链接的格式</span></span><br><span class="line"><span class="attr">pretty_urls:</span></span><br><span class="line">  <span class="attr">trailing_index:</span>   <span class="comment"># 是否在永久链接中保留尾部的 index.html，设置为 false 时去除</span></span><br><span class="line">  <span class="attr">trailing_html:</span>    <span class="comment"># 是否在永久链接中保留尾部的 .html, 设置为 false 时去除 (对尾部的 index.html无效)</span></span><br></pre></td></tr></table></figure>
<h2 id="5-2-导航栏配置"><a href="#5-2-导航栏配置" class="headerlink" title="5.2. 导航栏配置"></a>5.2. 导航栏配置</h2><p>导航栏的配置在项目文件夹下的主题配置文件 <strong><code>_config.butterfly.yml</code></strong> 中，其主要参数如下:<br><figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 左上角图标</span></span><br><span class="line"><span class="attr">nav:</span></span><br><span class="line">  <span class="attr">logo:</span>             <span class="comment"># 网站logo，支持图片，直接填入图片链接</span></span><br><span class="line">  <span class="attr">display_title:</span>    <span class="comment"># 是否显示网站标题</span></span><br><span class="line">  <span class="attr">fixed:</span>            <span class="comment"># 是否固定导航栏</span></span><br><span class="line"></span><br><span class="line"><span class="attr">menu:</span>               <span class="comment"># 菜单栏设置,，该主题的菜单栏在顶部导航栏的右侧，从上到下，依次从左至右排布</span></span><br><span class="line">  <span class="attr">Home:</span> <span class="string">/</span> <span class="string">||</span> <span class="string">fas</span> <span class="string">fa-home</span></span><br><span class="line">  <span class="attr">Archives:</span> <span class="string">/archives/</span> <span class="string">||</span> <span class="string">fas</span> <span class="string">fa-archive</span></span><br><span class="line">  <span class="attr">Tags:</span> <span class="string">/tags/</span> <span class="string">||</span> <span class="string">fas</span> <span class="string">fa-tags</span></span><br><span class="line">  <span class="attr">Categories:</span> <span class="string">/categories/</span> <span class="string">||</span> <span class="string">fas</span> <span class="string">fa-folder-open</span></span><br><span class="line">  <span class="string">List</span> <span class="string">||</span> <span class="attr">fas fa-list:</span> <span class="string">||</span> <span class="attr">hide:</span></span><br><span class="line">    <span class="attr">Music:</span> <span class="string">/music/</span> <span class="string">||</span> <span class="string">fas</span> <span class="string">fa-music</span></span><br><span class="line">    <span class="attr">Movie:</span> <span class="string">/movies/</span> <span class="string">||</span> <span class="string">fas</span> <span class="string">fa-video</span></span><br><span class="line">  <span class="attr">Link:</span> <span class="string">/link/</span> <span class="string">||</span> <span class="string">fas</span> <span class="string">fa-link</span></span><br><span class="line">  <span class="attr">About:</span> <span class="string">/about/</span> <span class="string">||</span> <span class="string">fas</span> <span class="string">fa-heart</span></span><br><span class="line">  <span class="comment"># 多级按钮参数格式: 多级按钮名称(可自定义) || 图标(可自定义) || hide:(无此项则不隐藏子按钮)</span></span><br><span class="line">  <span class="comment"># 跳转按钮参数格式: 导航按钮名称(可自定义): 导航跳转页面对应的路径 || 图标(可自定义)</span></span><br></pre></td></tr></table></figure></p>
<table><tr><td bgcolor=MistyRose>跳转路径必須是 /xxx/， 图标名可不写，不写则不显示图标 </td></tr></table>

<h2 id="5-3-文章封面配置"><a href="#5-3-文章封面配置" class="headerlink" title="5.3. 文章封面配置"></a>5.3. 文章封面配置</h2><p>文章封面的配置在项目文件夹下的主题配置文件 <strong><code>_config.butterfly.yml</code></strong> 中，其主要参数如下:<br><figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">cover:</span></span><br><span class="line">  <span class="attr">index_enable:</span>             <span class="comment"># 主页是否显示文章封面图</span></span><br><span class="line">  <span class="attr">aside_enable:</span>             <span class="comment"># 侧栏是否显示文章封面图</span></span><br><span class="line">  <span class="attr">archives_enable:</span>          <span class="comment"># 归档页面是否显示文章封面图</span></span><br><span class="line">  <span class="attr">position:</span>                 <span class="comment"># 封面顯示的位置，三個值可配置 left , right , both(一左一右)</span></span><br><span class="line">  <span class="attr">default_cover:</span>            <span class="comment"># 默认封面，若文章页在Front-matter中配置了cover，则使用文章页中的配置项</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">/xxxxx</span>                <span class="comment"># 配置多项，则随机为其中一项</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">/xxxxxxxxxxxxxx</span></span><br></pre></td></tr></table></figure></p>
<h2 id="5-4-文章meta配置"><a href="#5-4-文章meta配置" class="headerlink" title="5.4. 文章meta配置"></a>5.4. 文章meta配置</h2><p>文章meta的配置在项目文件夹下的主题配置文件 <strong><code>_config.butterfly.yml</code></strong> 中，其主要参数如下:<br><figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">post_meta:</span>          <span class="comment"># 页面meta显示</span></span><br><span class="line">  <span class="attr">page:</span>             <span class="comment"># Home Page</span></span><br><span class="line">    <span class="attr">date_type:</span>      <span class="comment"># created or updated or both 主頁文章日期是創建日或者更新日或都顯示</span></span><br><span class="line">    <span class="attr">date_format:</span>    <span class="comment"># date/relative 顯示日期還是相對日期</span></span><br><span class="line">    <span class="attr">categories:</span>     <span class="comment"># true or false 主頁是否顯示分類</span></span><br><span class="line">    <span class="attr">tags:</span>           <span class="comment"># true or false 主頁是否顯示標籤</span></span><br><span class="line">    <span class="attr">label:</span>          <span class="comment"># true or false 顯示描述性文字</span></span><br><span class="line">  <span class="attr">post:</span></span><br><span class="line">    <span class="attr">date_type:</span>      <span class="comment"># created or updated or both 文章頁日期是創建日或者更新日或都顯示</span></span><br><span class="line">    <span class="attr">date_format:</span>    <span class="comment"># date/relative 顯示日期還是相對日期</span></span><br><span class="line">    <span class="attr">categories:</span>     <span class="comment"># true or false 文章頁是否顯示分類</span></span><br><span class="line">    <span class="attr">tags:</span>           <span class="comment"># true or false 文章頁是否顯示標籤</span></span><br><span class="line">    <span class="attr">label:</span>          <span class="comment"># true or false 顯示描述性文字</span></span><br><span class="line"></span><br><span class="line"><span class="attr">index_post_content:</span> <span class="comment"># 主页显示文章节选</span></span><br><span class="line">  <span class="attr">method:</span>           <span class="comment"># 1:显示描述；2:自动；3:截取一部分正文 false:不显示描述</span></span><br><span class="line">  <span class="attr">length:</span>           <span class="comment"># 截取文章前多少个字</span></span><br></pre></td></tr></table></figure></p>
<h2 id="5-5-顶部图片配置"><a href="#5-5-顶部图片配置" class="headerlink" title="5.5. 顶部图片配置"></a>5.5. 顶部图片配置</h2><p>顶部图片的配置在项目文件夹下的主题配置文件 <strong><code>_config.butterfly.yml</code></strong> 中，其主要参数如下:<br><figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 页面顶图配置</span></span><br><span class="line"><span class="comment"># category_per_img和tag_per_img，可配置多张，每次会随机取一张</span></span><br><span class="line"><span class="comment"># format:</span></span><br><span class="line"><span class="comment">#  - category name: xxxxx</span></span><br><span class="line"><span class="attr">disable_top_img:</span>       <span class="comment"># 全站不显示顶部图片</span></span><br><span class="line"><span class="attr">index_img:</span>             <span class="comment"># 首页的顶部图片</span></span><br><span class="line"><span class="attr">default_top_img:</span>       <span class="comment"># 默认的顶部图片</span></span><br><span class="line"><span class="attr">archive_img:</span>           <span class="comment"># 归档页顶部图片</span></span><br><span class="line"><span class="attr">tag_img:</span>               <span class="comment"># 标签页顶部图片</span></span><br><span class="line"><span class="attr">tag_per_img:</span>           <span class="comment"># 每个标签页的顶部图片，可配置多张</span></span><br><span class="line"><span class="attr">category_img:</span>          <span class="comment"># 分类页顶部图片</span></span><br><span class="line"><span class="attr">category_per_img:</span>      <span class="comment"># 每个分类页的顶部图片，可配置多张</span></span><br></pre></td></tr></table></figure></p>
<h2 id="5-6-文章内容配置"><a href="#5-6-文章内容配置" class="headerlink" title="5.6. 文章内容配置"></a>5.6. 文章内容配置</h2><p>文章内容的配置在项目文件夹下的主题配置文件 <strong><code>_config.butterfly.yml</code></strong> 中，其主要参数如下:<br><figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">noticeOutdate:</span>    <span class="comment"># 文章过期提醒，可设置是否显示文章过期提醒，以更新时间为基准。会在文章最上面提示一个弹出框说明过期信息</span></span><br><span class="line">  <span class="attr">enable:</span>         <span class="comment"># 是否启用该功能</span></span><br><span class="line">  <span class="attr">style:</span>          <span class="comment"># style: simple/flat</span></span><br><span class="line">  <span class="attr">limit_day:</span>      <span class="comment"># 距离更新时间多少天才显示文章过期提醒</span></span><br><span class="line">  <span class="attr">position:</span>       <span class="comment"># position: top/bottom</span></span><br><span class="line">  <span class="attr">message_prev:</span>   <span class="comment"># 天数之前的文字</span></span><br><span class="line">  <span class="attr">message_next:</span>   <span class="comment"># 天数之后的文字</span></span><br><span class="line"></span><br><span class="line"><span class="attr">post_edit:</span>        <span class="comment"># 文章是否可以编辑，在文章标题旁边显示一个编辑按钮，点击会跳转到对应的链接</span></span><br><span class="line">  <span class="attr">enable:</span>         <span class="comment"># 是否启用该功能</span></span><br><span class="line">  <span class="attr">url:</span>            <span class="comment"># 编辑该文章的链接</span></span><br><span class="line"></span><br><span class="line"><span class="attr">toc:</span>              <span class="comment"># 文章目录配置</span></span><br><span class="line">  <span class="attr">post:</span>           <span class="comment"># 文章页是否显示目录</span></span><br><span class="line">  <span class="attr">page:</span>           <span class="comment"># 普通页面是否显示目录</span></span><br><span class="line">  <span class="attr">number:</span>         <span class="comment"># 是否显示章节数</span></span><br><span class="line">  <span class="attr">expand:</span>         <span class="comment"># 是否展开 TOC</span></span><br><span class="line">  <span class="attr">style_simple:</span>   <span class="comment"># 简洁模式（侧边栏只显示 TOC, 只对文章页有效 ）</span></span><br><span class="line">  <span class="attr">scroll_percent:</span> <span class="comment"># 是否显示滚动进度百分比</span></span><br><span class="line"></span><br><span class="line"><span class="attr">copy:</span>             <span class="comment"># 复制配置，开启后复制内容后会加入版权信息</span></span><br><span class="line">  <span class="attr">enable:</span>         <span class="comment"># 是否启用该功能</span></span><br><span class="line">  <span class="attr">copyright:</span></span><br><span class="line">    <span class="attr">enable:</span>       <span class="comment"># 是否添加版权信息</span></span><br><span class="line">    <span class="attr">limit_count:</span>  <span class="comment"># 复制行数多于此行数配置时会默认添加版本信息</span></span><br><span class="line"></span><br><span class="line"><span class="attr">post_copyright:</span>   <span class="comment"># 版权配置</span></span><br><span class="line">  <span class="attr">enable:</span>         <span class="comment"># 是否启用该功能</span></span><br><span class="line">  <span class="attr">decode:</span>         <span class="comment"># true来显示中文网址</span></span><br><span class="line">  <span class="attr">author_href:</span>    <span class="comment"># 作者链接地址  </span></span><br><span class="line">  <span class="attr">license:</span>        <span class="comment"># 版权声明</span></span><br><span class="line">  <span class="attr">license_url:</span>    <span class="comment"># 版权声明链接</span></span><br><span class="line"><span class="comment"># 可在每个文章页的 Front-matter 中进行单独配置</span></span><br><span class="line"><span class="attr">copyright_author:</span>  </span><br><span class="line"><span class="attr">copyright_author_href:</span>  </span><br><span class="line"><span class="attr">copyright_url:</span> </span><br><span class="line"><span class="attr">copyright_info:</span></span><br><span class="line"></span><br><span class="line"><span class="attr">reward:</span>           <span class="comment"># 文章底部的打赏功能</span></span><br><span class="line">  <span class="attr">enable:</span>         <span class="comment"># 是否启用该功能</span></span><br><span class="line">  <span class="attr">QR_code:</span>        <span class="comment"># 可配置多个打赏二维码图片</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">/xxxx</span></span><br><span class="line"></span><br><span class="line"><span class="attr">post_pagination:</span>  <span class="comment"># 推送文章分页，1表示左侧推送上一篇，2表示左侧推送上一篇</span></span><br><span class="line"></span><br><span class="line"><span class="attr">sharejs:</span>          <span class="comment"># 文章分享设置</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">sites:</span>          <span class="comment"># 参数为:facebook,twitter,wechat,weibo,qq</span></span><br><span class="line"></span><br><span class="line"><span class="attr">addtoany:</span>         <span class="comment"># 文章分享设置，和上述分享设置二选一</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">false</span></span><br><span class="line">  <span class="attr">item:</span>           <span class="comment"># 参数为:facebook,twitter,wechat,sina_weibo,facebook_messenger,email,copy_link</span></span><br><span class="line"></span><br><span class="line"><span class="attr">related_post:</span>     <span class="comment"># 推荐文章设置</span></span><br><span class="line">  <span class="attr">enable:</span>  </span><br><span class="line">  <span class="attr">limit:</span>          <span class="comment"># 显示推荐文章数目</span></span><br><span class="line">  <span class="attr">date_type:</span>      <span class="comment"># created or updated 文章日期显示创建日或者更新日</span></span><br><span class="line"></span><br><span class="line"><span class="attr">photofigcaption:</span>  <span class="comment"># 是否显示图片的描述，优先显示图片的title属性，然后是alt属性</span></span><br></pre></td></tr></table></figure></p>
<h2 id="5-7-代码样式配置"><a href="#5-7-代码样式配置" class="headerlink" title="5.7. 代码样式配置"></a>5.7. 代码样式配置</h2><p>文章内容的配置在项目文件夹下的主题配置文件 <strong><code>_config.butterfly.yml</code></strong> 中，其主要参数如下:<br><figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">highlight_theme:</span>        <span class="comment"># 代码高亮：darker、light、ocean、mac、pale night、mac light</span></span><br><span class="line"><span class="attr">highlight_copy:</span>         <span class="comment"># 代码支持复制</span></span><br><span class="line"><span class="attr">highlight_shrink:</span>       <span class="comment"># 代码框是否默认展开，true表示不展开，需点击 &#x27;&gt;&#x27; 打开，可选值还有none，不显示 &#x27;&gt;&#x27;</span></span><br><span class="line"><span class="attr">highlight_lang:</span>         <span class="comment"># 是否显示语言</span></span><br><span class="line"><span class="attr">code_word_wrap:</span>         <span class="comment"># 代码自动换行，不会出现滚动条</span></span><br><span class="line"><span class="attr">highlight_height_limit:</span> <span class="comment"># unit: px，代码高度配置，超出部分会隐藏</span></span><br></pre></td></tr></table></figure></p>
<h2 id="5-8-社交图标配置"><a href="#5-8-社交图标配置" class="headerlink" title="5.8. 社交图标配置"></a>5.8. 社交图标配置</h2><p>社交图标的配置在项目文件夹下的主题配置文件 <strong><code>_config.butterfly.yml</code></strong> 中，其主要参数如下:<br><figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">social:</span></span><br><span class="line">  <span class="comment"># formal:</span></span><br><span class="line">  <span class="comment"># icon: link || the description || color </span></span><br><span class="line">  <span class="comment"># [icon]为图标的样式 [link]为图标点击后跳转的链接 [description]为该图标的描述 [color] 为该图标的颜色</span></span><br></pre></td></tr></table></figure></p>
<h2 id="5-9-页脚配置"><a href="#5-9-页脚配置" class="headerlink" title="5.9. 页脚配置"></a>5.9. 页脚配置</h2><p>页脚的配置在项目文件夹下的主题配置文件 <strong><code>_config.butterfly.yml</code></strong> 中，其主要参数如下:<br><figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">footer:</span></span><br><span class="line">  <span class="attr">owner:</span></span><br><span class="line">    <span class="attr">enable:</span>      </span><br><span class="line">    <span class="attr">since:</span>         <span class="comment"># 网站的建站时间</span></span><br><span class="line">  <span class="attr">custom_text:</span>     <span class="comment"># 自定义文本，支持HTML</span></span><br><span class="line">  <span class="attr">copyright:</span>       <span class="comment"># 显示博客的框架和主题  </span></span><br></pre></td></tr></table></figure></p>
<h2 id="5-10-侧边栏配置"><a href="#5-10-侧边栏配置" class="headerlink" title="5.10. 侧边栏配置"></a>5.10. 侧边栏配置</h2><p>侧边栏的配置在项目文件夹下的主题配置文件 <strong><code>_config.butterfly.yml</code></strong> 中，其主要参数如下:<br><figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">aside:</span></span><br><span class="line">  <span class="attr">enable:</span>         <span class="comment"># 启用侧边栏</span></span><br><span class="line">  <span class="attr">hide:</span>           <span class="comment"># 是否隐藏</span></span><br><span class="line">  <span class="attr">button:</span>         <span class="comment"># 是否显示右下角的按钮</span></span><br><span class="line">  <span class="attr">mobile:</span>         <span class="comment"># 是否在手机上显示</span></span><br><span class="line">  <span class="attr">position:</span>       <span class="comment"># 侧边栏的位置，left or right</span></span><br><span class="line">  <span class="attr">display:</span></span><br><span class="line">    <span class="attr">archive:</span>      <span class="comment"># 是否展示文章信息</span></span><br><span class="line">    <span class="attr">tag:</span>          <span class="comment"># 是否展示标签信息</span></span><br><span class="line">    <span class="attr">category:</span>     <span class="comment"># 是否展示分类信息</span></span><br><span class="line">  <span class="attr">card_author:</span></span><br><span class="line">    <span class="attr">enable:</span>       <span class="comment"># 是否显示作者栏卡片</span></span><br><span class="line">    <span class="attr">description:</span></span><br><span class="line">    <span class="attr">button:</span></span><br><span class="line">      <span class="attr">enable:</span>     <span class="comment"># 是否显示作者链接按钮</span></span><br><span class="line">      <span class="attr">icon:</span>       <span class="comment"># 图标</span></span><br><span class="line">      <span class="attr">text:</span>       <span class="comment"># 文字</span></span><br><span class="line">      <span class="attr">link:</span>       <span class="comment"># 链接</span></span><br><span class="line">  <span class="attr">card_announcement:</span></span><br><span class="line">    <span class="attr">enable:</span>       <span class="comment"># 是否显示公告栏</span></span><br><span class="line">    <span class="attr">content:</span>      <span class="comment"># 支持HTML</span></span><br><span class="line">  <span class="attr">card_recent_post:</span></span><br><span class="line">    <span class="attr">enable:</span>       <span class="comment"># 是否显示最新文章卡片</span></span><br><span class="line">    <span class="attr">limit:</span>        <span class="comment"># 显示数量，如果为0，则显示全部</span></span><br><span class="line">    <span class="attr">sort:</span>         <span class="comment"># 根据创建时间或更新时间排序</span></span><br><span class="line">    <span class="attr">sort_order:</span>   </span><br><span class="line">  <span class="attr">card_categories:</span></span><br><span class="line">    <span class="attr">enable:</span>       <span class="comment"># 是否显示分类卡片</span></span><br><span class="line">    <span class="attr">limit:</span>  </span><br><span class="line">    <span class="attr">expand:</span>  </span><br><span class="line">    <span class="attr">sort_order:</span>  </span><br><span class="line">  <span class="attr">card_tags:</span></span><br><span class="line">    <span class="attr">enable:</span>       <span class="comment"># 是否显示标签卡片</span></span><br><span class="line">    <span class="attr">limit:</span>  </span><br><span class="line">    <span class="attr">color:</span>        <span class="comment"># 是否使用色彩区分</span></span><br><span class="line">    <span class="attr">orderby:</span>  </span><br><span class="line">    <span class="attr">order:</span>  </span><br><span class="line">    <span class="attr">sort_order:</span></span><br><span class="line">  <span class="attr">card_archives:</span></span><br><span class="line">    <span class="attr">enable:</span>       <span class="comment"># 是否显示归档卡片</span></span><br><span class="line">    <span class="attr">type:</span>  </span><br><span class="line">    <span class="attr">format:</span>  </span><br><span class="line">    <span class="attr">order:</span> </span><br><span class="line">    <span class="attr">limit:</span> </span><br><span class="line">    <span class="attr">sort_order:</span>  </span><br><span class="line">  <span class="attr">card_webinfo:</span></span><br><span class="line">    <span class="attr">enable:</span>       <span class="comment"># 是否显示网站信息</span></span><br><span class="line">    <span class="attr">post_count:</span>   <span class="comment"># 文是否显示章数量</span></span><br><span class="line">    <span class="attr">last_push_date:</span>  <span class="comment"># 是否显示最后提交时间</span></span><br><span class="line">    <span class="attr">sort_order:</span>  </span><br></pre></td></tr></table></figure></p>
<h1 id="6-主题优化"><a href="#6-主题优化" class="headerlink" title="6. 主题优化"></a>6. 主题优化</h1><h2 id="6-1-背景一图流配置"><a href="#6-1-背景一图流配置" class="headerlink" title="6.1 背景一图流配置"></a>6.1 背景一图流配置</h2><p>主题背景一图流配置需要将页头和页脚加上透明遮罩，使得配置的背景图铺满整个网页<br>在项目文件夹下的 <strong><code>source/</code></strong> 文件夹下，新建一个CSS文件夹，并新建一个CSS文件 <strong><code>background</code></strong>, 其内容如下:</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* 页脚与头图透明 */</span></span><br><span class="line"><span class="selector-id">#footer</span> &#123;</span><br><span class="line">    <span class="attribute">background</span>: transparent <span class="meta">!important</span>;</span><br><span class="line">  &#125;</span><br><span class="line"><span class="selector-id">#page-header</span> &#123;</span><br><span class="line">    <span class="attribute">background</span>: transparent <span class="meta">!important</span>;</span><br><span class="line">&#125;</span><br><span class="line">  </span><br><span class="line"><span class="comment">/* 白天模式遮罩透明 */</span></span><br><span class="line"><span class="selector-id">#footer</span><span class="selector-pseudo">::before</span> &#123;</span><br><span class="line">    <span class="attribute">background</span>: transparent <span class="meta">!important</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#page-header</span><span class="selector-pseudo">::before</span> &#123;</span><br><span class="line">    <span class="attribute">background</span>: transparent <span class="meta">!important</span>;</span><br><span class="line">&#125;</span><br><span class="line">  </span><br><span class="line"><span class="comment">/* 夜间模式遮罩透明 */</span></span><br><span class="line"><span class="selector-attr">[data-theme=<span class="string">&quot;dark&quot;</span>]</span> </span><br><span class="line"><span class="selector-id">#footer</span><span class="selector-pseudo">::before</span> &#123;</span><br><span class="line">    <span class="attribute">background</span>: transparent <span class="meta">!important</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-attr">[data-theme=<span class="string">&quot;dark&quot;</span>]</span></span><br><span class="line"><span class="selector-id">#page-header</span><span class="selector-pseudo">::before</span> &#123;</span><br><span class="line">    <span class="attribute">background</span>: transparent <span class="meta">!important</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>在主题中引用该CSS文件, 同时需要关闭主页顶部图片和页脚图片，修改主题配置文件 <strong><code>_config.butterfly.yml</code></strong><br><figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">disable_top_img:</span> <span class="literal">false</span>  <span class="comment"># 设置为false</span></span><br><span class="line"><span class="attr">index_img:</span>              <span class="comment"># 留空</span></span><br><span class="line"><span class="attr">background:</span>             <span class="comment"># 设置为自己想要的背景图 e.g. url(/assets/pixiv/736461.png)</span></span><br><span class="line"><span class="attr">footer_bg:</span> <span class="literal">false</span>        <span class="comment"># 设置为false</span></span><br><span class="line"></span><br><span class="line"><span class="attr">inject:</span></span><br><span class="line">  <span class="attr">head:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">&lt;link</span> <span class="string">rel=&quot;stylesheet&quot;</span> <span class="string">href=&quot;/css/background.css&quot;&gt;</span></span><br></pre></td></tr></table></figure></p>
<h2 id="6-2-搜索功能"><a href="#6-2-搜索功能" class="headerlink" title="6.2. 搜索功能"></a>6.2. 搜索功能</h2><p>使用本地搜索，详情: <a href="https://github.com/next-theme/hexo-generator-searchdb">https://github.com/next-theme/hexo-generator-searchdb</a><br>安装 <code>hexo-generator-searchdb</code><br><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">npm install hexo-generator-searchdb</span><br></pre></td></tr></table></figure></p>
<p>修改配置文件 <strong><code>_config.yml</code></strong><br><figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">search:</span></span><br><span class="line">  <span class="attr">path:</span> <span class="string">search.xml</span></span><br><span class="line">  <span class="attr">field:</span> <span class="string">post</span></span><br><span class="line">  <span class="attr">content:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">format:</span> <span class="string">html</span></span><br></pre></td></tr></table></figure></p>
<p>修改主题配置文件 <strong><code>_config.butterfly.yml</code></strong><br><figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">local_search:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">preload:</span> <span class="literal">false</span></span><br><span class="line">  <span class="attr">top_n_per_article:</span> <span class="number">1</span></span><br><span class="line">  <span class="attr">unescape:</span> <span class="literal">false</span></span><br><span class="line">  <span class="attr">CDN:</span></span><br></pre></td></tr></table></figure></p>
<h2 id="6-3-字数统计"><a href="#6-3-字数统计" class="headerlink" title="6.3. 字数统计"></a>6.3. 字数统计</h2><p>安装 <code>hexo-wordcount</code><br><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">npm install hexo-wordcount --save</span><br></pre></td></tr></table></figure></p>
<p>修改主题配置文件 <strong><code>_config.butterfly.yml</code></strong><br><figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">wordcount:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">post_wordcount:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">min2read:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">total_wordcount:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure></p>
<h2 id="6-4-外挂标签"><a href="#6-4-外挂标签" class="headerlink" title="6.4. 外挂标签"></a>6.4. 外挂标签</h2><p>安装 <code>npm install hexo-butterfly-tag-plugins-plus</code><br><figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="string">npm</span> <span class="string">install</span> <span class="string">hexo-butterfly-tag-plugins-plus</span> <span class="string">--save</span></span><br></pre></td></tr></table></figure></p>
<p><code>hexo</code> 自带的 <code>markdown</code> 渲染插件 <code>hexo-renderer-marked</code> 与外挂标签语法的兼容性较差，替换成 <code>hexo-renderer-kramed</code><br><figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="string">npm</span> <span class="string">uninstall</span> <span class="string">hexo-renderer-marked</span> <span class="string">--save</span></span><br><span class="line"><span class="string">npm</span> <span class="string">install</span> <span class="string">hexo-renderer-kramed</span> <span class="string">--save</span></span><br></pre></td></tr></table></figure></p>
<p>修改主题配置文件 <strong><code>_config.butterfly.yml</code></strong><br><figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># tag-plugins-plus</span></span><br><span class="line"><span class="comment"># see https://akilar.top/posts/615e2dec/</span></span><br><span class="line"><span class="attr">tag_plugins:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span>    <span class="comment"># 开关</span></span><br><span class="line">  <span class="attr">priority:</span> <span class="number">5</span>     <span class="comment"># 过滤器优先权</span></span><br><span class="line">  <span class="attr">issues:</span> <span class="literal">false</span>   <span class="comment"># issues标签依赖注入开关</span></span><br><span class="line">  <span class="attr">link:</span></span><br><span class="line">    <span class="attr">placeholder:</span>  <span class="comment"># link_card标签默认的图标图片</span></span><br><span class="line">  <span class="attr">CDN:</span></span><br><span class="line">    <span class="attr">anima:</span> <span class="string">https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@latest/lib/assets/font-awesome-animation.min.css</span> <span class="comment">#动画标签anima的依赖</span></span><br><span class="line">    <span class="attr">jquery:</span> <span class="string">https://npm.elemecdn.com/jquery@latest/dist/jquery.min.js</span> <span class="comment">#issues标签依赖</span></span><br><span class="line">    <span class="attr">issues:</span> <span class="string">https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@latest/lib/assets/issues.js</span> <span class="comment">#issues标签依赖</span></span><br><span class="line">    <span class="attr">iconfont:</span> <span class="string">//at.alicdn.com/t/font_2032782_8d5kxvn09md.js</span> <span class="comment">#参看https://akilar.top/posts/d2ebecef/</span></span><br><span class="line">    <span class="attr">carousel:</span> <span class="string">https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@latest/lib/assets/carousel-touch.js</span></span><br><span class="line">    <span class="attr">tag_plugins_css:</span> <span class="string">https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@latest/lib/tag_plugins.css</span></span><br></pre></td></tr></table></figure></p>
<h2 id="6-5-每页单独配置背景"><a href="#6-5-每页单独配置背景" class="headerlink" title="6.5. 每页单独配置背景"></a>6.5. 每页单独配置背景</h2><p>在需要配置的文章页或其他页的Markdown文件中加入一下配置样式<br><figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line">&#123;<span class="string">%</span> <span class="string">raw</span> <span class="string">%</span>&#125;</span><br><span class="line"><span class="string">&lt;style&gt;</span></span><br><span class="line"><span class="comment">#web_bg&#123;</span></span><br><span class="line">  <span class="attr">background:</span> <span class="string">url(/img/newbg.png)!important;</span></span><br><span class="line">  <span class="string">/*重新定义background会导致原有定位属性失效，所以也需要再声明一次加权的定位属性*/</span></span><br><span class="line">  <span class="attr">background-position:</span> <span class="string">center</span> <span class="type">!important;</span></span><br><span class="line">  <span class="attr">background-size:</span> <span class="string">cover</span> <span class="type">!important;</span></span><br><span class="line">  <span class="attr">background-repeat:</span> <span class="literal">no</span><span class="string">-repeat</span> <span class="type">!important;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">&lt;/style&gt;</span></span><br><span class="line">&#123;<span class="string">%</span> <span class="string">endraw</span> <span class="string">%</span>&#125;</span><br></pre></td></tr></table></figure></p>
]]></content>
      <categories>
        <category>教程</category>
      </categories>
      <tags>
        <tag>网站</tag>
        <tag>CSS</tag>
      </tags>
  </entry>
</search>
